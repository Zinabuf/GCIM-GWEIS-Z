% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gcim_gweis_b.R
\name{b_gweis}
\alias{b_gweis}
\title{Perform GWEIS for a binary phenotype and generate a GCIM input file}
\usage{
b_gweis(
  plink_path,
  tar_mydata,
  tar_pheno_file,
  tar_covar_file,
  int_covar_index = 1,
  out_file = "gcim_prs_int.txt",
  out_prefix = "b_gweis",
  threads = 40,
  pheno_col = 3,
  covar_col_range = "3-",
  standardize_covar = TRUE,
  ensure_12 = TRUE,
  show_plink_output = TRUE
)
}
\arguments{
\item{plink_path}{Character. Path to PLINK2 executable.}

\item{tar_mydata}{Character. Prefix of PLINK binary files (.bed/.bim/.fam).}

\item{tar_pheno_file}{Character OR list. Phenotype file with columns: FID IID PHENO
(binary PHENO typically 0/1 or 1/2 in column \code{pheno_col}). Can pass previous-step output list.}

\item{tar_covar_file}{Character OR list. Covariate file with columns: FID IID COVAR1...
(COVAR1 is typically PRS in column 3). Minimum 3 columns required.}

\item{int_covar_index}{Integer. Covariate index for interaction term:
1 -> ADDxCOVAR1, 2 -> ADDxCOVAR2, ...}

\item{out_file}{Character. Name of GCIM interaction output file (default "gcim_prs_int.txt").}

\item{out_prefix}{Character. PLINK output prefix inside tmp_dir (default "b_gweis").}

\item{threads}{Integer. Threads for PLINK (default 40).}

\item{pheno_col}{Integer. Phenotype column number (default 3).}

\item{covar_col_range}{Character. Covariate column range for PLINK (default "3-").
Note: this function computes explicit covariate column numbers internally for robustness.}

\item{standardize_covar}{Logical. Use --covar-variance-standardize (default TRUE).}

\item{ensure_12}{Logical. If TRUE, recode 0/1 phenotype to 1/2 in a temp file (default TRUE).}

\item{show_plink_output}{Logical. Print stderr head + log tail on PLINK error (default TRUE).}
}
\value{
A list with file paths and metadata.
}
\description{
Runs PLINK2 logistic regression with SNP x covariate interaction and exports
interaction results (ADDxCOVARk) in GCIM format.
}
\details{
Improvements vs your draft:
\itemize{
\item Prints PLINK stderr head + log tail automatically on non-zero exit (e.g., exit 8)
\item Robustly reads phenotype/covar files even if headerless; accepts EID -> IID
\item Adds binary phenotype validation and optional recoding (0/1 -> 1/2) in a temp file
\item Uses --glm interaction hide-covar for logistic model
\item Robustly extracts effect size (prefer BETA; else log(OR); else log(OR_ALT))
\item Returns pipeline-friendly files/meta
}
}
