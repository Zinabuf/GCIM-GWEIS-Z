% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gcim_gweis_b.R
\name{b_gweis}
\alias{b_gweis}
\title{Perform GWEIS for a binary phenotype and generate a GCIM input file}
\usage{
b_gweis(
  plink_path,
  tar_mydata,
  tar_pheno_file,
  tar_covar_file,
  int_covar_index = 1,
  out_file = "gcim_prs_int.txt",
  out_prefix = "b_gweis",
  threads = 40,
  pheno_col = 3,
  standardize_covar = TRUE,
  ensure_12 = TRUE,
  show_plink_output = TRUE,
  gcim_sep = c("tab", "space"),
  keep_tmp = TRUE
)
}
\arguments{
\item{plink_path}{Path to PLINK2 executable.}

\item{tar_mydata}{Prefix for target PLINK files (.bed/.bim/.fam).}

\item{tar_pheno_file}{Path to phenotype file (FID IID + phenotype column).}

\item{tar_covar_file}{Path to covariate file (FID IID + covariates).}

\item{int_covar_index}{Integer index (1-based) of covariate to interact with ADD.}

\item{out_file}{Output GCIM file name (saved under the temporary directory).}

\item{out_prefix}{Prefix for PLINK output files (saved under the temporary directory).}

\item{threads}{Number of threads for PLINK2.}

\item{pheno_col}{Integer column number of phenotype in \code{tar_pheno_file} (>= 3).}

\item{standardize_covar}{Logical; standardize covariates using
\code{--covar-variance-standardize}.}

\item{ensure_12}{Logical; if TRUE, recode binary phenotype 0/1 -> 1/2 when needed.}

\item{show_plink_output}{Logical; on PLINK error, print stderr head + log tail.}

\item{gcim_sep}{Output delimiter for GCIM file: \code{"tab"} or \code{"space"}.}

\item{keep_tmp}{Logical; keep the temporary working directory.}
}
\value{
Invisibly returns a list containing paths to the \code{.glm} file, GCIM file,
temporary directory, and metadata.
}
\description{
Runs PLINK2 logistic regression with SNP x covariate interaction and exports
interaction results in GCIM format.
}
\details{
Key behavior:
\itemize{
\item Writes GCIM file as tab-delimited by default (so read.delim() reads columns correctly)
\item Robustly detects interaction term: prefers ADDx\if{html}{\out{<covarName>}} (e.g., ADDxcovt),
else ADDxCOVARk
}
}
