% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/all_prs.R
\name{prs_scores}
\alias{prs_scores}
\title{Compute polygenic risk scores (PRS) in a target sample}
\usage{
prs_scores(plink_path, tar_snp, score_file)
}
\arguments{
\item{plink_path}{Character. Path to the PLINK (v2.0) executable.}

\item{tar_snp}{Character. Prefix of PLINK binary files
(.bed/.bim/.fam) for the target dataset.}

\item{score_file}{Character. File path to SNP effect file generated by
\code{q_gwas()} or \code{b_gwas()}.
The file must contain the columns ID (SNP ID), A1 (effect allele),
and BETA.}
}
\value{
A list containing PRS outputs stored in a temporary directory:
\describe{
\item{sscore_file}{Path to PLINK .sscore file}
\item{prs_scaled_file}{Path to scaled PRS file}
\item{prs_scaled}{Data frame with FID, IID, and scaled PRS}
\item{tmp_dir}{Temporary directory used by the function}
\item{log_file}{Path to PLINK log file}
\item{n_samples}{Number of samples with PRS computed}
\item{n_variants}{Number of variants used in PRS}
}
}
\description{
This function computes PRS using PLINK2 based on SNP effect sizes
obtained from GWAS (quantitative or binary) and scales the resulting
PRS for downstream GCIM-GWEIS-Z analyses. All outputs are saved to
a temporary directory.
}
\details{
This function performs the following steps:
\enumerate{
\item Validates input files (PLINK binaries and score file)
\item Creates a temporary directory for all outputs
\item Runs PLINK score to compute raw PRS values
\item Standardizes PRS to mean zero and standard deviation one
\item Saves scaled PRS for downstream GCIM-GWEIS-Z analysis
}

The score file must have columns in the following order:
ID, A1, and BETA. These are referenced by PLINK as columns 1, 2, and 3.
}
