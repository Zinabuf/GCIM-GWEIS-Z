% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gcim_gweis_q.R
\name{q_gweis}
\alias{q_gweis}
\title{Perform GWEIS for a quantitative phenotype and generate a GCIM input file}
\usage{
q_gweis(
  plink_path,
  tar_mydata,
  tar_pheno_file,
  tar_covar_file,
  int_covar_index = 1,
  out_file = "gcim_prs_int.txt",
  out_prefix = "q_gweis",
  threads = 40,
  pheno_col = 3,
  standardize_covar = TRUE,
  standardize_pheno = FALSE,
  show_plink_output = TRUE
)
}
\arguments{
\item{plink_path}{Character. Path to PLINK2 executable.}

\item{tar_mydata}{Character. Prefix of PLINK binary files (.bed/.bim/.fam).}

\item{tar_pheno_file}{Character OR list. Phenotype file with columns: FID IID PHENO
(PHENO should be in column 3). Can also pass output from previous pipeline step.}

\item{tar_covar_file}{Character OR list. Covariate file with columns: FID IID COVAR1...
(COVAR1 is column 3, typically PRS). Minimum 3 columns required.}

\item{int_covar_index}{Integer. Covariate index for interaction term:
1 -> ADDxCOVAR1 (typically PRS in column 3), 2 -> ADDxCOVAR2, ...}

\item{out_file}{Character. Name of GCIM interaction output file (default "gcim_prs_int.txt").}

\item{out_prefix}{Character. PLINK output prefix inside tmp_dir (default "q_gweis").}

\item{threads}{Integer. Optional threads for PLINK (default 40).}

\item{pheno_col}{Integer. Phenotype column number in phenotype file (default 3).}

\item{standardize_covar}{Logical. Use --covar-variance-standardize (default TRUE).}

\item{standardize_pheno}{Logical. Use --pheno-variance-standardize (default FALSE; safer).}

\item{show_plink_output}{Logical. Print stderr head + log tail on PLINK error (default TRUE).}
}
\value{
A list with file paths and metadata.
}
\description{
Runs PLINK2 linear regression with SNP x covariate interaction and exports
interaction results (ADDxCOVARk) in GCIM format.
}
\details{
Key improvements vs your current version:
\itemize{
\item Prints helpful PLINK stderr/log snippets automatically on error (exit code 8, etc.)
\item Robust phenotype/covariate reading (accepts headerless files; accepts EID -> IID)
\item Optional phenotype variance standardization (off by default to avoid PLINK failures)
\item Optional additional covariate standardization (on by default)
\item Clearer diagnostics about sample overlap (pheno/covar vs .fam)
}
}
