% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/merge.prs.R
\name{replace_covariate_with_prs}
\alias{replace_covariate_with_prs}
\title{Replace the third column with PRS}
\usage{
replace_covariate_with_prs(
  qp_dis_cov,
  prs_file,
  out_name = "qp_dis_cov_prs.txt"
)
}
\arguments{
\item{qp_dis_cov}{Character. Path to the original phenotype and covariate file.
Must contain columns FID and IID, and at least one additional column.}

\item{prs_file}{Character. Path to PRS file from \code{prs_scores()}.
Must contain columns FID, IID, and PRS.}

\item{out_name}{Character. Name for output file (default: "qp_dis_cov_prs.txt").}
}
\value{
A list with:
\describe{
\item{output_file}{Path to the output file with PRS replacing column 3}
\item{tmp_dir}{Temporary directory used by the function}
\item{n_samples}{Number of samples in the output}
\item{n_cols}{Number of columns in the output}
\item{col3_replaced}{Name of the original third column that was replaced}
}
}
\description{
This function merges PRS values into a phenotype and covariate file and
replaces the third column (the quantitative phenotype or interaction covariate)
with the computed PRS. This is used in the GCIM-GWEIS-Z pipeline to prepare
data for gene by environment interaction testing.
}
\details{
This function performs the following steps:
\enumerate{
\item Validates input files exist and have required columns
\item Reads phenotype and covariate file and PRS file
\item Merges datasets by FID and IID
\item Replaces column 3 with PRS values
\item Saves output to a temporary directory
}

The output file maintains the original column structure but with PRS
substituted into position 3, ready for analysis.
}
